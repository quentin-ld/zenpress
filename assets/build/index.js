(()=>{"use strict";var e={n:s=>{var t=s&&s.__esModule?()=>s.default:()=>s;return e.d(t,{a:t}),t},d:(s,t)=>{for(var n in t)e.o(t,n)&&!e.o(s,n)&&Object.defineProperty(s,n,{enumerable:!0,get:t[n]})},o:(e,s)=>Object.prototype.hasOwnProperty.call(e,s)};const s=window.wp.domReady;var t=e.n(s);const n=window.wp.element,a=window.wp.i18n,r=window.wp.components,i=window.wp.data,c=window.wp.notices,o=window.wp.apiFetch;var l=e.n(o);const p=window.ReactJSXRuntime,d=({label:e,value:s,onChange:t,help:a})=>{const i=(0,n.useRef)(null);return(0,n.useEffect)(()=>((e,s)=>{if(!e)return;const t=t=>{if("Enter"===t.key){const n=e.querySelector('input[type="checkbox"]'),a=e.ownerDocument||document;n&&(a.activeElement===n||e.contains(a.activeElement))&&(t.preventDefault(),t.stopPropagation(),s())}};return e.addEventListener("keydown",t),()=>{e.removeEventListener("keydown",t)}})(i.current,t),[t]),(0,p.jsx)("div",{ref:i,children:(0,p.jsx)(r.ToggleControl,{label:e,checked:s,onChange:t,help:a,__nextHasNoMarginBottom:!0})})},u=({onClick:e,isBusy:s})=>(0,p.jsx)(r.Button,{variant:"primary",onClick:e,isBusy:s,__next40pxDefaultSize:!0,children:(0,a.__)("Save settings","zenpress")}),b=()=>{const{removeNotice:e}=(0,i.useDispatch)(c.store),s=(0,i.useSelect)(e=>e(c.store).getNotices(),[]);return s&&0!==s.length?(0,p.jsx)(r.NoticeList,{notices:s,onRemove:e}):null},h=(0,n.createContext)(),_=({selectedTabId:e,onSelect:s,orientation:t="horizontal",children:a})=>{const[r,i]=(0,n.useState)(),c=(0,n.useRef)(null),o=void 0!==e?e:r;return(0,p.jsx)(h.Provider,{value:{selectedTabId:o,onSelect:t=>{void 0===e&&i(t),s?.(t)},orientation:t,getOrderedTabIds:()=>c.current?Array.from(c.current.querySelectorAll('[role="tab"]')).map(e=>{const s=e.getAttribute("id");return s?s.replace("zenpress-tab-",""):null}).filter(Boolean):[],tabListRef:c},children:(0,p.jsx)("div",{className:`zenpress-tabs zenpress-tabs--${t}`,children:a})})};_.TabList=({children:e})=>{const{orientation:s,tabListRef:t}=(0,n.useContext)(h);return(0,p.jsx)("div",{ref:t,className:`zenpress-tabs__list zenpress-tabs__list--${s}`,role:"tablist","aria-orientation":s,children:e})},_.Tab=({tabId:e,title:s,className:t="",children:a})=>{const{selectedTabId:r,onSelect:i,orientation:c,getOrderedTabIds:o}=(0,n.useContext)(h),l=r===e,d=(0,n.useRef)(null);return(0,p.jsx)("button",{ref:d,className:`zenpress-tabs__tab ${l?"zenpress-tabs__tab--is-active":""} ${t}`.trim(),role:"tab","aria-selected":l,"aria-controls":`zenpress-tab-panel-${e}`,id:`zenpress-tab-${e}`,tabIndex:l?0:-1,onClick:()=>i(e),onKeyDown:s=>{const t=o();if(!t||0===t.length)return;const n=t.indexOf(e);if(-1===n)return;let a=n;if("vertical"===c?"ArrowDown"===s.key?(s.preventDefault(),a=n<t.length-1?n+1:0):"ArrowUp"===s.key&&(s.preventDefault(),a=n>0?n-1:t.length-1):"ArrowRight"===s.key?(s.preventDefault(),a=n<t.length-1?n+1:0):"ArrowLeft"===s.key&&(s.preventDefault(),a=n>0?n-1:t.length-1),"Home"===s.key?(s.preventDefault(),a=0):"End"===s.key&&(s.preventDefault(),a=t.length-1)," "===s.key||"Enter"===s.key)return s.preventDefault(),void i(e);if(a!==n&&a>=0&&a<t.length){const e=t[a],s=document.getElementById(`zenpress-tab-${e}`);s&&(s.focus(),i(e))}},onFocus:()=>{l||i(e)},children:s||a})},_.TabPanel=({tabId:e,children:s})=>{const{selectedTabId:t}=(0,n.useContext)(h),a=(0,n.useRef)(null),r=t===e;return(0,n.useEffect)(()=>{r&&a.current&&(0===a.current.querySelectorAll('a[href], button:not([disabled]), [tabindex]:not([tabindex="-1"]), input:not([disabled]), select:not([disabled]), textarea:not([disabled])').length?a.current.setAttribute("tabindex","0"):a.current.removeAttribute("tabindex"))},[r]),r?(0,p.jsx)("div",{ref:a,className:"zenpress-tabs__panel",role:"tabpanel",id:`zenpress-tab-panel-${e}`,"aria-labelledby":`zenpress-tab-${e}`,children:s}):(0,p.jsx)("div",{className:"zenpress-tabs__panel",role:"tabpanel",id:`zenpress-tab-panel-${e}`,"aria-labelledby":`zenpress-tab-${e}`,hidden:!0,children:s})};const z=()=>{const{snippets:e,setSnippets:s,adminBarEnabled:t,setAdminBarEnabled:o,saveSettings:h,isSaving:z}=(()=>{const[e,s]=(0,n.useState)({}),[t,r]=(0,n.useState)(!0),[o,p]=(0,n.useState)(!1),{createSuccessNotice:d,createErrorNotice:u}=(0,i.useDispatch)(c.store);return(0,n.useEffect)(()=>{l()({path:"/wp/v2/settings"}).then(e=>{const t=Array.isArray(e?.zenpress_active_snippets)?e.zenpress_active_snippets:[],n=window?.zenpressSnippetsMeta||{},a={};Object.keys(n).forEach(e=>{a[e]={...n[e],"enable-snippet":t.includes(e)}}),s(a),r(!1!==e?.zenpress_admin_bar_enabled)}).catch(()=>{u((0,a.__)("Failed to load settings.","zenpress"))})},[u]),{snippets:e,setSnippets:s,adminBarEnabled:t,setAdminBarEnabled:r,saveSettings:async()=>{p(!0);const s=Object.keys(e).filter(s=>e[s]?.["enable-snippet"]);try{await l()({path:"/wp/v2/settings",method:"POST",data:{zenpress_active_snippets:s,zenpress_admin_bar_enabled:t}}),d((0,a.__)("Settings saved.","zenpress"))}catch{u((0,a.__)("Failed to save settings.","zenpress"))}finally{p(!1)}},isSaving:o}})(),[f,m]=(0,n.useState)(),[g,v]=(0,n.useState)(null),{createSuccessNotice:x,createErrorNotice:y}=(0,i.useDispatch)(c.store),j=e=>{s(s=>{const t={};return Object.entries(s).forEach(([s,n])=>{const a=(Array.isArray(n?.preset)?n.preset:[]).includes(e);t[s]={...n,"enable-snippet":a}}),t})},w=e=>e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e,S=["core","gutenberg","woocommerce","ads-blocker","tools"],k={};Object.keys(e).forEach(s=>{const t=e[s],n=(t?.category||(0,a.__)("Uncategorized","zenpress")).toLowerCase(),r=(t?.subcategory||(0,a.__)("uncategorized","zenpress")).toLowerCase();k[n]||(k[n]={}),k[n][r]||(k[n][r]=[]),k[n][r].push({name:s,data:t})});const C=Object.keys(k).sort((e,s)=>{const t=S.indexOf(e.toLowerCase()),n=S.indexOf(s.toLowerCase());return-1!==t&&-1!==n?t-n:-1!==t?-1:-1!==n?1:e.localeCompare(s,void 0,{sensitivity:"base"})});(0,n.useEffect)(()=>{!f&&C.length>0&&m(C[0])},[f,C]);const E=async(e,s,t,n)=>{v(e);try{const e=await l()({path:s,method:"POST"});x(e?.message||t)}catch{y(n)}finally{v(null)}},A=()=>E("autoptimize","/zenpress/v1/autoconfig/autoptimize",(0,a.__)("Autoptimize has been configured.","zenpress"),(0,a.__)("Autoptimize autoconfig failed. Is Autoptimize installed and active?","zenpress")),N=()=>E("cache_enabler","/zenpress/v1/autoconfig/cache-enabler",(0,a.__)("Cache Enabler has been configured.","zenpress"),(0,a.__)("Cache Enabler autoconfig failed. Is Cache Enabler installed and active?","zenpress")),O=()=>E("sqlite_object_cache","/zenpress/v1/autoconfig/sqlite-object-cache",(0,a.__)("SQLite Object Cache has been configured.","zenpress"),(0,a.__)("SQLite Object Cache autoconfig failed. Is SQLite Object Cache installed and active?","zenpress"));return(0,n.useEffect)(()=>{const e=e=>{(e.ctrlKey||e.metaKey)&&"s"===e.key&&(e.preventDefault(),z||h())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[h,z]),(0,p.jsxs)("article",{className:"zenpress-row",children:[(0,p.jsxs)("section",{className:"zenpress-main",children:[(0,p.jsx)("div",{className:"zenpress-notices",children:(0,p.jsx)(b,{})}),(0,p.jsxs)("div",{className:"zenpress-panel",children:[(0,p.jsxs)(_,{orientation:"vertical",selectedTabId:f,onSelect:e=>{m(e),m(e)},children:[(0,p.jsx)(_.TabList,{children:C.map(e=>{const s=`zenpress-tabs__tab--category-${e.toLowerCase().replace(/\s+/g,"-")}`;return(0,p.jsx)(_.Tab,{tabId:e,title:w(e),className:s,children:w(e)},e)})}),C.map(e=>{const n=Object.keys(k[e]).sort();return(0,p.jsxs)(_.TabPanel,{tabId:e,children:[(0,p.jsx)("h2",{children:w(e)}),n.map(t=>(0,p.jsxs)("div",{className:`zenpress-subcategory zenpress-subcategory-${t.toLowerCase().replace(/\s+/g,"-")}`,children:[(0,p.jsx)("hr",{}),(0,p.jsx)("h3",{children:w(t)}),k[e][t].map(({name:e,data:t})=>(0,p.jsx)(d,{label:t.title||e,value:t?.["enable-snippet"]||!1,onChange:()=>{return t=e,void s(e=>({...e,[t]:{...e[t],"enable-snippet":!e[t]?.["enable-snippet"]}}));var t},help:t.description||""},e))]},t)),"tools"===e&&Object.values(window?.zenpressIntegrationsActive||{}).some(Boolean)&&(0,p.jsxs)("div",{className:"zenpress-subcategory zenpress-subcategory-integrations",children:[(0,p.jsx)("hr",{}),(0,p.jsx)("h3",{children:(0,a.__)("Integrations","zenpress")}),(0,p.jsx)(d,{label:(0,a.__)("Show ZenPress admin bar button","zenpress"),value:t,onChange:()=>o(!t),help:(0,a.__)('Show a "ZenPress" item in the admin bar with "Clear caches". When enabled, integration buttons (e.g. Autoptimize) are hidden.',"zenpress")}),window?.zenpressIntegrationsActive?.autoptimize&&(0,p.jsxs)("div",{className:"zenpress-autoconfig-actions",children:[(0,p.jsx)(r.Button,{variant:"secondary",onClick:A,disabled:null!==g,__next40pxDefaultSize:!0,children:"autoptimize"===g?(0,a.__)("Applyingâ€¦","zenpress"):(0,a.__)("One-click autoconfig Autoptimize","zenpress")}),(0,p.jsx)("p",{className:"zenpress-autoconfig-help",children:(0,a.__)("Apply recommended Autoptimize settings (optimize JS/CSS, aggregate CSS, static files, 404 fallbacks; disable defer, HTML optimize, optimize for logged-in, per post/page). Only works if Autoptimize is active.","zenpress")})]}),window?.zenpressIntegrationsActive?.cache_enabler&&(0,p.jsxs)("div",{className:"zenpress-autoconfig-actions",children:[(0,p.jsx)(r.Button,{variant:"secondary",onClick:N,disabled:null!==g,__next40pxDefaultSize:!0,children:"cache_enabler"===g?(0,a.__)("Applyingâ€¦","zenpress"):(0,a.__)("One-click autoconfig Cache Enabler","zenpress")}),(0,p.jsx)("p",{className:"zenpress-autoconfig-help",children:(0,a.__)("Apply recommended Cache Enabler settings. Only works if Cache Enabler is active.","zenpress")})]}),window?.zenpressIntegrationsActive?.sqlite_object_cache&&(0,p.jsxs)("div",{className:"zenpress-autoconfig-actions",children:[(0,p.jsx)(r.Button,{variant:"secondary",onClick:O,disabled:null!==g,__next40pxDefaultSize:!0,children:"sqlite_object_cache"===g?(0,a.__)("Applyingâ€¦","zenpress"):(0,a.__)("One-click autoconfig SQLite Object Cache","zenpress")}),(0,p.jsx)("p",{className:"zenpress-autoconfig-help",children:(0,a.__)("Apply recommended SQLite Object Cache settings. Only works if SQLite Object Cache is active.","zenpress")})]})]})]},e)})]}),(0,p.jsxs)("div",{className:"zenpress-actions",children:[(0,p.jsxs)("div",{className:"zenpress-actions-bulk",children:[(0,p.jsx)(r.Button,{variant:"tertiary",onClick:()=>{s(e=>{const s={};return Object.keys(e).forEach(t=>{s[t]={...e[t],"enable-snippet":!0}}),s})},__next40pxDefaultSize:!0,children:(0,a.__)("Enable all actions","zenpress")}),(0,p.jsx)(r.Button,{isDestructive:!0,onClick:()=>{s(e=>{const s={};return Object.keys(e).forEach(t=>{s[t]={...e[t],"enable-snippet":!1}}),s})},__next40pxDefaultSize:!0,children:(0,a.__)("Disable all actions","zenpress")})]}),(0,p.jsx)(u,{onClick:h,isBusy:z})]})]})]}),(0,p.jsx)("aside",{className:"zenpress-sidebar",children:(0,p.jsx)("div",{className:"zenpress-presets",children:(0,p.jsxs)("div",{className:"zenpress-presets-description",children:[(0,p.jsx)("h2",{children:(0,a.__)("Pick configuration preset","zenpress")}),(0,p.jsx)("p",{children:(0,a.__)("Don't know which features to enable? Quickly configure ZenPress by selecting a preset that matches your site type. Each preset enables optimized features for your specific use case.","zenpress")}),(0,p.jsx)("hr",{}),(0,p.jsxs)("h3",{children:["ðŸ–¼ï¸ ",(0,a.__)("Corporate website","zenpress")]}),(0,p.jsx)("p",{children:(0,a.__)("Optimized for business sites and portfolios. Focuses on security, performance, and removing unnecessary features like RSS feeds and author archives.","zenpress")}),(0,p.jsx)(r.Button,{variant:"secondary",onClick:()=>j("corporate-website"),__next40pxDefaultSize:!0,children:(0,a.__)("Enable","zenpress")}),(0,p.jsx)("hr",{}),(0,p.jsxs)("h3",{children:[" ðŸ“° ",(0,a.__)("Blog","zenpress")]}),(0,p.jsx)("p",{children:(0,a.__)("Tailored for content-focused blogs. Includes performance and security optimizations while preserving essential blog features like RSS feeds.","zenpress")}),(0,p.jsx)(r.Button,{variant:"secondary",onClick:()=>j("blog"),__next40pxDefaultSize:!0,children:(0,a.__)("Enable","zenpress")}),(0,p.jsx)("hr",{}),(0,p.jsxs)("h3",{children:["ðŸ›’ ",(0,a.__)("E-commerce","zenpress")]}),(0,p.jsx)("p",{children:(0,a.__)("Designed for WooCommerce stores. Includes all performance and security features plus WooCommerce-specific optimizations for faster checkout.","zenpress")}),(0,p.jsx)(r.Button,{variant:"secondary",onClick:()=>j("ecommerce"),__next40pxDefaultSize:!0,children:(0,a.__)("Enable","zenpress")})]})})})]})};t()(()=>{const e=document.getElementById("zenpress-settings");e&&(0,n.createRoot)(e).render((0,p.jsx)(z,{}))})})();